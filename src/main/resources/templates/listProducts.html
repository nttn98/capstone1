<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

    <head th:replace="~{homePage :: head}"></head>
    <link rel="styleSheet" href="/css/listProducts.css">
    <link rel="styleSheet" href="/css/theme-custom.css">


    <title>List products</title>

    <body>
        <div class="header_section" style="background-repeat: repeat;">
            <div th:replace="~{homePage :: header_section}"></div>
            <div>
                <h2 style="text-align: center; margin-top: 20px; margin-bottom: -25px;">Shop</h2>
            </div>
            <div class="breadcrumb-wrapper">
                <div class="breadcrumb-area breadcrumbs overlay-bg">
                    <div class="container">
                        <div class="row">
                            <div class="col-12">
                                <div class="breadcrumb-content text-center">
                                    <nav class role="navigation" aria-label="breadcrumbs">
                                        <ul class="breadcrumb-list">
                                            <li>
                                                <a href="/" title="Back to the home page">Home</a>
                                            </li>
                                            <li>
                                                <span>Products</span>
                                            </li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- BREADCRUMBS SETCTION END -->
            <div class="container">
                <div class="row">
                    <div class="col-lg-2">
                        <a href="/list-products">
                            <p style="font-size: 18px;">All products</p>
                        </a>
                        <ul>
                            <p style="margin-bottom: 10px; font-size: 18px">Categories</p>
                            <li th:each="category: ${categories}" th:if="${category.getProducts().size() > 0}">
                                <!-- th:href="@{/products-by-category(categoryName=${category.getName()})}" -->
                                <a th:href="@{/products-by-category(categoryName=${category.getName()})}">
                                    <div class="checkbox-wrapper">
                                        <div class="cbx">
                                            <input th:id="'cbx-' + ${category.getId()}" type="checkbox" disabled />
                                            <label th:for="'cbx-' + ${category.getId()}"></label>
                                            <svg width="15" height="14" viewBox="0 0 15 14" fill="none">
                                                <path d="M2 8.36364L6.23077 12L13 2"></path>
                                            </svg>
                                        </div>
                                    </div>
                                    <span th:text="${category.getName()}"></span>
                                </a>
                                <span th:text="' (' + ${category.getProducts().size()} + ')'"
                                    style="position: absolute; right: 0;"></span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-lg-10">
                        <hr style="width: 600px;">
                        <div class="item" th:each=" item: ${products}">
                            <div class="card mb-3">
                                <div class="row no-gutters" style="align-items: center;">
                                    <div class="col-lg-3">
                                        <img th:src="${item.getImages()}">
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="card-body">
                                            <h5 class="card-title" th:text="${item.getName()}"></h5>
                                            <p class="card-text" th:text="${item.getDescription()}"></p>

                                            <p class="card-text" style="font-weight: 600;">Category: <span
                                                    th:text="${item.getCategory().getName()}"
                                                    style="font-weight: normal;"></span></p>

                                            <p class="card-text" style="font-weight: 600;">Manufacturer: <span
                                                    th:text="${item.getManufacturer().getName()}"
                                                    style="font-weight: normal;"></span>
                                            </p>
                                            <p class="card-text" style="font-weight: 600;">Price: <span
                                                    th:text="${item.getPrice()}" style="font-weight: normal;"
                                                    class="formatPrice"></span>
                                            </p>
                                            <p class="card-text" style="font-weight: 600; color: green;">Available in
                                                stock: <span th:text="${item.getQuantity()}"
                                                    style="font-weight: normal;"></span>
                                            </p>
                                        </div>
                                    </div>
                                    <div class="col-lg-3" th:if="${item.getQuantity()!=0}">
                                        <a th:href="@{'/users/add-to-cart/' + ${item.id} + '?mode=' + inList}">
                                            <button class="button-89" role="button"
                                                style="margin-top: 60px; margin-left: 90px;">Add to
                                                cart
                                            </button>
                                        </a>
                                    </div>
                                    <div class="col-lg-3" th:if="${item.getQuantity()==0}">
                                        <h5 style="padding-left: 70px">Out of stock</h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="margin-left: 520px; padding-bottom: 15px;"
                        th:if="${products.getNumberOfElements() != 0}">
                        <div class="dataTables_paginate paging_simple_numbers"
                            th:each=" item: ${products.getTotalPages()}">
                            <ul class="pagination">
                                <li
                                    th:class="'paginate_button page-item previous ' + (${products.number == 0 ? 'disabled' : ''})">
                                    <a class="page-link"
                                        th:href="@{'/paging?page=' + ${products.number - 1}}">Previous</a>
                                </li>
                                <li class="paginate_button page-item active" th:each="page : ${#numbers.sequence(0, products.totalPages - 1)}">
                                <a th:href="@{'/paging?page=' + ${page}}"
                               th:class="'page-link ' + (${products.number == page ? 'current-page' : ''})"
                               th:text="${page + 1}"></a>
                                </li>
                                <li th:class="'paginate_button page-item next ' + (${products.number == products.totalPages - 1 ? 'disabled' : ''})">
                                    <a class="page-link" th:href="@{'/paging?page=' + ${products.number + 1}}">Next</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>

    <footer th:replace=" ~{homePage.html :: footer_section}">
    </footer>
    <button id="topButton"><i class="fa fa-arrow-up"></i></button>

    <script th:inline="javascript">
        var idCategory = /*[[${idCategory}]]*/ null; // Retrieve idCategory from Thymeleaf
        if ( idCategory )
        {
            var checkboxes = document.querySelectorAll( '.cbx input[type="checkbox"]' );
            checkboxes.forEach( function ( checkbox )
            {
                if ( checkbox.id === "cbx-" + idCategory )
                {
                    checkbox.checked = true; // Check the checkbox with the given ID
                }
            } );
        }
        alert_action(/*[[${ alert }]]*/ )
    </script>


</html>